def load_segmentation_model(weights_folder_path, device='cuda'):
    # Assuming the model weights are saved as 'segmentation_model.pth' in the specified folder
    weights_path = Path(weights_folder_path) / 'segmentation_model.pth'

    if not weights_path.exists():
        raise FileNotFoundError(f"Segmentation model weights not found at: {weights_path}")

    # Replace with your actual implementation for loading the segmentation model
    # Example: Loading a segmentation model from a checkpoint
    segmentation_model = torch.load(weights_path, map_location=device)
    segmentation_model = segmentation_model.to(device).eval()
    return segmentation_model

segment_weights_folder_path = "./path/to/your/segmentation/model/folder"
segment_model = load_segmentation_model(segment_weights_folder_path, device=device)
